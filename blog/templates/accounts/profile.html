{% extends "blog/base.html" %}
{% load i18n %}
{% load static %}
{% block head %}
<link rel="stylesheet" href="{% static 'accounts/css/profile.css' %}">
<script src="{% static 'accounts/js/profile.js' %}"></script>

{% endblock %}

{% block content %}
<div class="profile-container">
    <div class="profile-header">
        <div class="profile-image-container">
            {% if profile.profile_picture %}
                <img src="{{ profile.profile_picture.url }}" alt="{{ profile.user.username }}" class="profile-picture">
            {% else %}
                <img src="https://via.placeholder.com/150" alt="{{ profile.user.username }}" class="profile-picture">
            {% endif %}
        </div>
        <div class="profile-info">
            <h2><span class="username">{{ profile.user.username }}</span></h2>
            <div class="profile-stats">
                <span><strong>{{ user_posts.count }}</strong> 게시물</span>
                <span><strong id="follower-count">{{ profile.followers.count }}</strong> 팔로워</span>
                <span><strong>{{ profile.user.following.count }}</strong> 팔로우</span>
            </div>
            <div class="profile-actions">
                {% if is_own_profile %}
                    <a href="{% url 'profile_update' %}" class="btn btn-outline-secondary">프로필 편집</a>
                    <a href="{% url 'user_dashboard' %}" class="btn btn-outline-info">대시보드 보기</a>
                {% elif user.is_authenticated and user != profile.user %}
                    <button id="follow-btn" class="btn btn-primary" data-username="{{ profile.user.username }}">
                        {% if is_following %}
                            Unfollow
                        {% else %}
                            Follow
                        {% endif %}
                    </button>
                {% endif %}
            </div>
        </div>
    </div>

    <div class="profile-bio">
        <p><strong>{{ profile.bio }}</strong></p>
        <p>{{ profile.location }}</p>
    </div>

    <div class="profile-posts">
        <h3 class="section-title">게시물</h3>
        <div class="post-grid">
            {% for post in user_posts %}
                <div class="post">
                    <a href="{% url 'post_detail' post.pk %}">
                        {% if post.head_image %}
                            <img src="{{ post.head_image.url }}" alt="{{ post.title }}">
                        {% else %}
                            <img src="https://via.placeholder.com/300x300" alt="No Image">
                        {% endif %}
                    </a>
                </div>
            {% empty %}
                <p>{% trans "No posts yet." %}</p>
            {% endfor %}
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
{% endblock %}